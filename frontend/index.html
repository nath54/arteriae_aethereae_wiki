<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arteriae Aethereae Engine</title>
    <link rel="stylesheet" href="css/style.css">

    <!-- Dependencies -->
    <!-- (Basic Markdown Parser to be included here, or written in JS) -->
    <script src="js/markdown.js" defer></script>

    <!-- App Scripts -->
    <script src="js/data.js" defer></script>
    <script src="js/graph.js" defer></script>
    <script src="js/renderer.js" defer></script>
    <script src="js/tools.js" defer></script>
    <script src="js/ui_menu.js" defer></script>
    <script src="js/ui_cards.js" defer></script>
    <script src="js/ui_timeline.js" defer></script>
    <script src="js/router.js" defer></script>
    <script src="js/app.js" defer></script>
</head>

<body class="fantasy-theme">
    <div id="app-container">
        <!-- Left Sidebar: Hierarchy Menu -->
        <nav id="left-sidebar">
            <div class="sidebar-header">
                <h2>Arteriae Aethereae</h2>
            </div>
            <div id="tree-menu" class="tree-menu">
                <!-- Data populated dynamically via ui_menu.js -->
                <div class="loading-text">Loading world...</div>
            </div>
        </nav>

        <!-- Center Panel: Map Canvas -->
        <main id="map-container">
            <!-- Tools Overlay -->
            <div id="map-toolbar">
                <button class="tool-btn active" data-tool="view" title="View / Panning">View</button>

                <div class="edit-tools" style="display: none;">

                    <div class="tool-separator"></div>
                    <button class="tool-btn" data-tool="move_point"
                        title="Move Point (Border constrained)">Move</button>
                    <button class="tool-btn" data-tool="split_segment" title="Split Segment">Split Line</button>
                    <button class="tool-btn" data-tool="subdivide_segment" title="Subdivide Segment">Subdivide</button>
                    <button class="tool-btn" data-tool="unsplit_segment" title="Join Areas">Join</button>
                    <button class="tool-btn" data-tool="delete_point" title="Delete Point">Delete Point</button>
                    <button class="tool-btn" data-tool="assign_region" title="Assign Region">Assign Region</button>
                </div>

                <div class="tool-separator"></div>
                <button class="tool-btn" id="btn-export-svg">Export SVG</button>
                <button class="tool-btn" id="btn-export-png">Export PNG</button>
            </div>

            <svg id="map-svg" width="100%" height="100%" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <filter id="glow">
                        <feGaussianBlur stdDeviation="2.5" result="coloredBlur" />
                        <feMerge>
                            <feMergeNode in="coloredBlur" />
                            <feMergeNode in="SourceGraphic" />
                        </feMerge>
                    </filter>
                    <!-- Background texture or pattern can be added here -->
                    <pattern id="parchment-pattern" patternUnits="userSpaceOnUse" width="400" height="400">
                        <!-- We will style the main map background in CSS, but SVGs can use patterns too -->
                    </pattern>
                </defs>
                <g id="map-layers">
                    <g id="layer-regions"></g>
                    <g id="layer-borders"></g>
                    <!-- other map elements generated by renderer.js -->
                </g>
            </svg>
        </main>

        <!-- Right Panel: Contextual Entity Cards -->
        <aside id="right-panel">
            <div id="entity-card" class="parchment-card hidden">
                <button id="close-card" class="close-btn">&times;</button>
                <div id="card-content">
                    <!-- Entity details populated here -->
                </div>
            </div>
        </aside>
    </div>
</body>

</html>